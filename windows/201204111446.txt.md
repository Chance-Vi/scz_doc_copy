5.55 在Win7 PFW中禁止主动访问除192.168.1.0/24之外的任何IP

http://scz.617.cn/windows/201204111446.txt

Q:

想在Win7 PFW中禁止主动访问除192.168.1.0/24之外的任何IP。打开高级设置，在出
站规则里先建了一条规则，禁止主动访问所有远程IP。接着在出站规则里再建一条规
则，允许访问192.168.1.0/24。实测发现，无法访问192.168.1.0/24。

不想动用第三方PFW或自己写驱动实现。

A: scz@nsfocus 2012-04-11 14:46

对于Win7自带PFW，阻止操作始终优先于允许操作，没有更灵活的可配置优先级一说。
为达原始目的，在出站规则里建一条阻止规则，指定远程IP地址:

0.0.0.0-192.168.0.255
192.168.2.0-255.255.255.255

netsh.exe advfirewall firewall add rule name="只允许访问192.168.1.0/24" enable=yes dir=out action=block remoteip=0.0.0.0-192.168.0.255,192.168.2.0-255.255.255.255
netsh.exe advfirewall firewall show rule name="只允许访问192.168.1.0/24"
